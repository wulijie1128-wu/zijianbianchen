<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech Test</title>
</head>
<body>
    <h1>语音合成测试</h1>
    <button onclick="testSpeech()">🔊 测试语音</button>
    <button onclick="speakWord()">🗣️ 说 "Hello"</button>
    <button onclick="speakCat()">🐱 说 "Cat"</button>

    <div id="status" style="margin-top: 20px; padding: 10px; background: #f0f0f0;"></div>

    <script>
        function updateStatus(message) {
            document.getElementById('status').innerHTML += message + '<br>';
            console.log(message);
        }

        function testSpeech() {
            updateStatus('=== 开始测试语音合成 ===');

            if ('speechSynthesis' in window) {
                updateStatus('✅ 浏览器支持语音合成');

                const voices = speechSynthesis.getVoices();
                updateStatus(`可用语音数量: ${voices.length}`);

                if (voices.length === 0) {
                    updateStatus('⚠️ 语音还未加载，等待中...');
                    speechSynthesis.onvoiceschanged = () => {
                        const newVoices = speechSynthesis.getVoices();
                        updateStatus(`语音加载完成，数量: ${newVoices.length}`);
                        listVoices();
                    };
                } else {
                    listVoices();
                }
            } else {
                updateStatus('❌ 浏览器不支持语音合成');
            }
        }

        function listVoices() {
            const voices = speechSynthesis.getVoices();
            const englishVoices = voices.filter(voice => voice.lang.startsWith('en'));
            updateStatus(`英语语音数量: ${englishVoices.length}`);

            if (englishVoices.length > 0) {
                updateStatus('可用的英语语音:');
                englishVoices.forEach((voice, index) => {
                    updateStatus(`${index + 1}. ${voice.name} (${voice.lang})`);
                });
            }
        }

        function speakWord() {
            updateStatus('尝试说 "Hello"...');
            const utterance = new SpeechSynthesisUtterance('Hello');

            utterance.onstart = () => updateStatus('✅ 开始播放: Hello');
            utterance.onend = () => updateStatus('✅ 播放结束: Hello');
            utterance.onerror = (e) => updateStatus(`❌ 播放出错: ${e.error}`);

            utterance.rate = 0.8;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            utterance.lang = 'en-US';

            speechSynthesis.speak(utterance);
        }

        function speakCat() {
            updateStatus('尝试说 "Cat"...');
            const utterance = new SpeechSynthesisUtterance('cat');

            utterance.onstart = () => updateStatus('✅ 开始播放: Cat');
            utterance.onend = () => updateStatus('✅ 播放结束: Cat');
            utterance.onerror = (e) => updateStatus(`❌ 播放出错: ${e.error}`);

            utterance.rate = 0.7;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            utterance.lang = 'en-US';

            speechSynthesis.speak(utterance);
        }

        // 页面加载时自动测试
        window.addEventListener('load', () => {
            setTimeout(testSpeech, 1000);
        });
    </script>
</body>
</html>