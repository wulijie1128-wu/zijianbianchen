<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‰∏≠ÊñáÂèñÂêçÁ•ûÂô® - ‰∏ì‰∏öÂÆùÂÆùËµ∑ÂêçÂ∑•ÂÖ∑</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", "PingFang SC", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 16px;
            opacity: 0.95;
        }

        .form-section {
            padding: 40px 30px;
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-group label {
            display: block;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
        }

        .form-group label .required {
            color: #f5576c;
        }

        .form-group input[type="text"],
        .form-group input[type="date"] {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
        }

        .gender-options,
        .meaning-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .radio-card {
            position: relative;
        }

        .radio-card input[type="radio"],
        .radio-card input[type="checkbox"] {
            position: absolute;
            opacity: 0;
        }

        .radio-card label {
            display: block;
            padding: 14px 28px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #666;
        }

        .radio-card input:checked + label {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102,126,234,0.3);
        }

        .radio-card label:hover {
            border-color: #667eea;
        }

        .generate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(102,126,234,0.4);
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102,126,234,0.5);
        }

        .generate-btn:active {
            transform: translateY(0);
        }

        .results-section {
            padding: 40px 30px;
            background: #f8f9fa;
            display: none;
        }

        .results-section.show {
            display: block;
        }

        .results-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .results-header h2 {
            font-size: 26px;
            color: #333;
            margin-bottom: 8px;
        }

        .results-header p {
            color: #666;
            font-size: 14px;
        }

        .name-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border-left: 4px solid #667eea;
        }

        .name-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .name-card .name-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .name-card .name-text {
            font-size: 28px;
            font-weight: 700;
            color: #333;
        }

        .name-card .score {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 600;
        }

        .name-card .name-info {
            margin-bottom: 12px;
        }

        .name-card .info-row {
            display: flex;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .name-card .info-label {
            color: #888;
            min-width: 70px;
        }

        .name-card .info-value {
            color: #333;
            flex: 1;
        }

        .name-card .actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .action-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .action-btn:hover {
            background: #667eea;
            color: white;
        }

        .action-btn.favorited {
            background: #667eea;
            color: white;
        }

        .regenerate-btn {
            display: block;
            width: 100%;
            padding: 14px;
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .regenerate-btn:hover {
            background: #667eea;
            color: white;
        }

        .favorites-section {
            padding: 40px 30px;
            display: none;
        }

        .favorites-section.show {
            display: block;
        }

        .tab-buttons {
            display: flex;
            gap: 10px;
            padding: 20px 30px 0;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab-btn {
            padding: 12px 24px;
            background: transparent;
            border: none;
            color: #666;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: #667eea;
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #667eea;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        @media (max-width: 600px) {
            .header h1 {
                font-size: 24px;
            }

            .form-section,
            .results-section,
            .favorites-section {
                padding: 30px 20px;
            }

            .gender-options,
            .meaning-options {
                flex-direction: column;
            }

            .radio-card label {
                text-align: center;
            }

            .name-card .name-text {
                font-size: 24px;
            }
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéã ‰∏≠ÊñáÂèñÂêçÁ•ûÂô®</h1>
            <p>‰∏ì‰∏öÂÆùÂÆùËµ∑ÂêçÂ∑•ÂÖ∑ ¬∑ Âü∫‰∫éÈü≥Âæã„ÄÅ‰∫îË°å„ÄÅÂØìÊÑèÊô∫ËÉΩÊé®Ëçê</p>
        </div>

        <div class="tab-buttons">
            <button class="tab-btn active" onclick="switchTab('generate')">Êô∫ËÉΩÂèñÂêç</button>
            <button class="tab-btn" onclick="switchTab('favorites')">Êî∂ËóèÂ§π (<span id="favorites-count">0</span>)</button>
        </div>

        <div class="form-section" id="generate-tab">
            <form id="name-form">
                <div class="form-group">
                    <label><span class="required">*</span> ÂßìÊ∞è</label>
                    <input type="text" id="surname" placeholder="ËØ∑ËæìÂÖ•ÂßìÊ∞èÔºåÂ¶ÇÔºöÂº†„ÄÅÊùé„ÄÅÁéã" required maxlength="2">
                </div>

                <div class="form-group">
                    <label><span class="required">*</span> ÊÄßÂà´</label>
                    <div class="gender-options">
                        <div class="radio-card">
                            <input type="radio" id="male" name="gender" value="male" required>
                            <label for="male">üë¶ Áî∑Â≠©</label>
                        </div>
                        <div class="radio-card">
                            <input type="radio" id="female" name="gender" value="female">
                            <label for="female">üëß Â•≥Â≠©</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Âá∫ÁîüÊó•ÊúüÔºàÂèØÈÄâÔºåÁî®‰∫é‰∫îË°åÂàÜÊûêÔºâ</label>
                    <input type="date" id="birthdate">
                </div>

                <div class="form-group">
                    <label>ÊúüÊúõÂØìÊÑèÔºàÂèØÂ§öÈÄâÔºâ</label>
                    <div class="meaning-options">
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-wisdom" value="Êô∫ÊÖß">
                            <label for="meaning-wisdom">üí° Êô∫ÊÖßËÅ™È¢ñ</label>
                        </div>
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-virtue" value="ÂìÅÂæ∑">
                            <label for="meaning-virtue">üåü ÂìÅÂæ∑È´òÂ∞ö</label>
                        </div>
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-health" value="ÂÅ•Â∫∑">
                            <label for="meaning-health">üí™ ÂÅ•Â∫∑Âπ≥ÂÆâ</label>
                        </div>
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-success" value="ÊàêÂäü">
                            <label for="meaning-success">üèÜ ‰∫ã‰∏öÊúâÊàê</label>
                        </div>
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-beauty" value="Áæé‰∏Ω">
                            <label for="meaning-beauty">üå∏ Áæé‰∏Ω‰ºòÈõÖ</label>
                        </div>
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-courage" value="ÂãáÊï¢">
                            <label for="meaning-courage">‚öîÔ∏è ÂãáÊï¢ÂùöÂº∫</label>
                        </div>
                    </div>
                </div>

                <button type="submit" class="generate-btn">‚ú® ÂºÄÂßãÊô∫ËÉΩÂèñÂêç</button>
            </form>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Ê≠£Âú®‰∏∫ÊÇ®Á≤æÂøÉÊåëÈÄâÂ•ΩÂêçÂ≠ó...</p>
        </div>

        <div class="results-section" id="results-section">
            <div class="results-header">
                <h2>‰∏∫ÊÇ®Êé®Ëçê‰ª•‰∏ãÂ•ΩÂêçÂ≠ó</h2>
                <p>Â∑≤Ê†πÊçÆÈü≥Âæã„ÄÅ‰∫îË°å„ÄÅÂØìÊÑèÁªºÂêàÂàÜÊûê</p>
            </div>
            <div id="results-container"></div>
            <button class="regenerate-btn" onclick="regenerateNames()">üîÑ Êç¢‰∏ÄÊâπ</button>
        </div>

        <div class="favorites-section" id="favorites-tab">
            <div class="results-header">
                <h2>ÊàëÁöÑÊî∂Ëóè</h2>
                <p>ÊÇ®Êî∂ËóèÁöÑÂêçÂ≠óÂ∞Ü‰øùÂ≠òÂú®Êú¨Âú∞</p>
            </div>
            <div id="favorites-container"></div>
        </div>
    </div>

    <script>
        // ÂêçÂ≠óÂ∫ì
        const nameDatabase = {
            male: {
                single: [
                    { char: 'ËΩ©', pinyin: 'xuƒÅn', meaning: 'Ê∞îÂÆáËΩ©ÊòÇ', element: 'Âúü', tags: ['Êô∫ÊÖß', 'ÂìÅÂæ∑'] },
                    { char: 'ÂÆá', pinyin: 'y«î', meaning: 'ËÉ∏ÊÄÄÂÆΩÂπø', element: 'Âúü', tags: ['Êô∫ÊÖß', 'ÊàêÂäü'] },
                    { char: 'Êµ©', pinyin: 'h√†o', meaning: 'Êµ©ÁÑ∂Ê≠£Ê∞î', element: 'Ê∞¥', tags: ['ÂãáÊï¢', 'ÂìÅÂæ∑'] },
                    { char: 'Áùø', pinyin: 'ru√¨', meaning: 'ËÅ™ÊòéÁùøÊô∫', element: 'Èáë', tags: ['Êô∫ÊÖß'] },
                    { char: 'Âçö', pinyin: 'b√≥', meaning: 'ÂçöÂ≠¶Â§öÊâç', element: 'Ê∞¥', tags: ['Êô∫ÊÖß', 'ÊàêÂäü'] },
                    { char: 'Áø∞', pinyin: 'h√†n', meaning: 'ÊñáÈááÈ£ûÊâ¨', element: 'Ê∞¥', tags: ['Êô∫ÊÖß', 'ÊàêÂäü'] },
                    { char: 'Ê≥Ω', pinyin: 'z√©', meaning: 'ÊÅ©Ê≥Ω‰∏áÁâ©', element: 'Ê∞¥', tags: ['ÂìÅÂæ∑', 'ÊàêÂäü'] },
                    { char: 'Êô®', pinyin: 'ch√©n', meaning: 'ÊúùÊ∞îËì¨ÂãÉ', element: 'ÁÅ´', tags: ['ÂÅ•Â∫∑', 'ÊàêÂäü'] },
                    { char: 'ÊØÖ', pinyin: 'y√¨', meaning: 'ÂùöÊØÖÊûúÊï¢', element: 'Êú®', tags: ['ÂãáÊï¢', 'ÊàêÂäü'] },
                    { char: 'Êù∞', pinyin: 'ji√©', meaning: 'Ëã±ÈõÑË±™Êù∞', element: 'Êú®', tags: ['ÂãáÊï¢', 'ÊàêÂäü'] },
                    { char: 'Áëû', pinyin: 'ru√¨', meaning: 'Á••ÁëûÂêâÁ••', element: 'Èáë', tags: ['ÂÅ•Â∫∑', 'ÂìÅÂæ∑'] },
                    { char: 'ÁÖú', pinyin: 'y√π', meaning: 'ÂÖâÊòéÁÖßËÄÄ', element: 'ÁÅ´', tags: ['ÊàêÂäü', 'Êô∫ÊÖß'] },
                ],
                double: [
                    { chars: 'ÂÆáËà™', pinyin: 'y«îh√°ng', meaning: 'ÂøóÂêëÈ´òËøú', element: 'ÂúüÊ∞¥', tags: ['Êô∫ÊÖß', 'ÊàêÂäü'] },
                    { chars: 'Êµ©ÁÑ∂', pinyin: 'h√†or√°n', meaning: 'Êµ©ÁÑ∂Ê≠£Ê∞î', element: 'Ê∞¥Èáë', tags: ['ÂìÅÂæ∑', 'ÂãáÊï¢'] },
                    { chars: 'Êô®Êõ¶', pinyin: 'ch√©nxƒ´', meaning: 'ÊúùÈò≥ÂàùÂçá', element: 'ÁÅ´ÁÅ´', tags: ['ÂÅ•Â∫∑', 'ÊàêÂäü'] },
                    { chars: 'ÁùøÊ≥Ω', pinyin: 'ru√¨z√©', meaning: 'Êô∫ÊÖßÊÅ©Ê≥Ω', element: 'ÈáëÊ∞¥', tags: ['Êô∫ÊÖß', 'ÂìÅÂæ∑'] },
                    { chars: 'ÂçöÊñá', pinyin: 'b√≥w√©n', meaning: 'ÂçöÂ≠¶Â§öËØÜ', element: 'Ê∞¥Ê∞¥', tags: ['Êô∫ÊÖß', 'ÊàêÂäü'] },
                    { chars: 'Â≠êËΩ©', pinyin: 'z«êxuƒÅn', meaning: 'Áø©Áø©ÂêõÂ≠ê', element: 'Ê∞¥Âúü', tags: ['ÂìÅÂæ∑', 'Êô∫ÊÖß'] },
                    { chars: 'ÁÖúÁ•∫', pinyin: 'y√πq√≠', meaning: 'ÂÖâÊòéÂêâÁ••', element: 'ÁÅ´Êú®', tags: ['ÊàêÂäü', 'ÂÅ•Â∫∑'] },
                    { chars: '‰øäÊù∞', pinyin: 'j√πnji√©', meaning: 'Ëã±‰øäË±™Êù∞', element: 'ÁÅ´Êú®', tags: ['ÂãáÊï¢', 'ÊàêÂäü'] },
                ]
            },
            female: {
                single: [
                    { char: 'Ëê±', pinyin: 'xuƒÅn', meaning: 'Áæé‰∏ΩÂø´‰πê', element: 'Êú®', tags: ['Áæé‰∏Ω', 'ÂÅ•Â∫∑'] },
                    { char: 'Áë∂', pinyin: 'y√°o', meaning: 'ÁæéÁéâÊó†Áëï', element: 'ÁÅ´', tags: ['Áæé‰∏Ω', 'ÂìÅÂæ∑'] },
                    { char: 'Â©∑', pinyin: 't√≠ng', meaning: 'Â©ÄÂ®úÂ§öÂßø', element: 'ÁÅ´', tags: ['Áæé‰∏Ω'] },
                    { char: 'ÈõÖ', pinyin: 'y«é', meaning: 'Ê∏©ÊñáÂ∞îÈõÖ', element: 'Êú®', tags: ['ÂìÅÂæ∑', 'Áæé‰∏Ω'] },
                    { char: 'ÊÖß', pinyin: 'hu√¨', meaning: 'ËÅ™ÊÖß‰º∂‰øê', element: 'Ê∞¥', tags: ['Êô∫ÊÖß'] },
                    { char: 'Áê≥', pinyin: 'l√≠n', meaning: 'ÁæéÁéâÂÖâÂΩ©', element: 'Êú®', tags: ['Áæé‰∏Ω'] },
                    { char: 'Ê∂µ', pinyin: 'h√°n', meaning: 'Ê∂µÂÖª‰øÆÂÖª', element: 'Ê∞¥', tags: ['ÂìÅÂæ∑', 'Êô∫ÊÖß'] },
                    { char: 'Ê¨£', pinyin: 'xƒ´n', meaning: 'Ê¨£Ê¨£ÂêëËç£', element: 'Êú®', tags: ['ÂÅ•Â∫∑', 'Áæé‰∏Ω'] },
                    { char: 'ÊÇ¶', pinyin: 'yu√®', meaning: 'ÂñúÊÇ¶Âø´‰πê', element: 'Èáë', tags: ['ÂÅ•Â∫∑', 'Áæé‰∏Ω'] },
                    { char: 'Ëä∏', pinyin: 'y√∫n', meaning: 'Âã§Â•ã‰∏äËøõ', element: 'Êú®', tags: ['Êô∫ÊÖß', 'ÊàêÂäü'] },
                    { char: 'È¢ñ', pinyin: 'y«êng', meaning: 'ËÅ™È¢ñÂá∫‰ºó', element: 'Êú®', tags: ['Êô∫ÊÖß', 'ÊàêÂäü'] },
                    { char: 'Â©â', pinyin: 'w«én', meaning: 'Ê∏©Â©âË¥§Ê∑ë', element: 'Âúü', tags: ['Áæé‰∏Ω', 'ÂìÅÂæ∑'] },
                ],
                double: [
                    { chars: 'ÈõÖÊ∂µ', pinyin: 'y«éh√°n', meaning: '‰ºòÈõÖÂê´ËìÑ', element: 'Êú®Ê∞¥', tags: ['ÂìÅÂæ∑', 'Áæé‰∏Ω'] },
                    { chars: 'ËØóÊ∂µ', pinyin: 'shƒ´h√°n', meaning: 'ËØóÊÉÖÁîªÊÑè', element: 'ÈáëÊ∞¥', tags: ['Êô∫ÊÖß', 'Áæé‰∏Ω'] },
                    { chars: 'Ê¢¶Áê™', pinyin: 'm√®ngq√≠', meaning: 'ÁæéÊ¢¶ÊàêÁúü', element: 'Êú®Êú®', tags: ['Áæé‰∏Ω', 'ÊàêÂäü'] },
                    { chars: 'Ê¨£ÊÄ°', pinyin: 'xƒ´ny√≠', meaning: 'Ê¨£ÂñúÊÑâÊÇ¶', element: 'Êú®Âúü', tags: ['ÂÅ•Â∫∑', 'Áæé‰∏Ω'] },
                    { chars: 'ËØ≠Â´£', pinyin: 'y«îyƒÅn', meaning: 'Â∑ßÁ¨ëÂ´£ÁÑ∂', element: 'Êú®Âúü', tags: ['Áæé‰∏Ω', 'ÂìÅÂæ∑'] },
                    { chars: 'Â©âÂ©∑', pinyin: 'w«ént√≠ng', meaning: 'Â©âÁ∫¶Â©∑Â©∑', element: 'ÂúüÁÅ´', tags: ['Áæé‰∏Ω', 'ÂìÅÂæ∑'] },
                    { chars: 'ÊÄùÊÖß', pinyin: 'sƒ´hu√¨', meaning: 'ÊÄùÁª¥ÊïèÊÖß', element: 'ÈáëÊ∞¥', tags: ['Êô∫ÊÖß'] },
                    { chars: 'ÊÇ¶ÂΩ§', pinyin: 'yu√®t√≥ng', meaning: 'ÂñúÊÇ¶Â¶ÇÈò≥', element: 'ÈáëÁÅ´', tags: ['ÂÅ•Â∫∑', 'Áæé‰∏Ω'] },
                ]
            }
        };

        let currentFormData = null;
        let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');

        // Êõ¥Êñ∞Êî∂ËóèËÆ°Êï∞
        function updateFavoritesCount() {
            document.getElementById('favorites-count').textContent = favorites.length;
        }

        // ÂàáÊç¢Ê†áÁ≠æÈ°µ
        function switchTab(tab) {
            const tabs = document.querySelectorAll('.tab-btn');
            tabs.forEach(t => t.classList.remove('active'));

            if (tab === 'generate') {
                document.querySelector('.tab-btn:first-child').classList.add('active');
                document.getElementById('generate-tab').style.display = 'block';
                document.getElementById('favorites-tab').classList.remove('show');
                document.getElementById('results-section').style.display = 'none';
            } else {
                document.querySelector('.tab-btn:last-child').classList.add('active');
                document.getElementById('generate-tab').style.display = 'none';
                document.getElementById('results-section').style.display = 'none';
                document.getElementById('favorites-tab').classList.add('show');
                displayFavorites();
            }
        }

        // Ë°®ÂçïÊèê‰∫§
        document.getElementById('name-form').addEventListener('submit', function(e) {
            e.preventDefault();
            generateNames();
        });

        // ÁîüÊàêÂêçÂ≠ó
        function generateNames() {
            const surname = document.getElementById('surname').value.trim();
            const gender = document.querySelector('input[name="gender"]:checked').value;
            const birthdate = document.getElementById('birthdate').value;
            const meanings = Array.from(document.querySelectorAll('input[type="checkbox"]:checked'))
                .map(cb => cb.value);

            currentFormData = { surname, gender, birthdate, meanings };

            // ÊòæÁ§∫Âä†ËΩΩÂä®Áîª
            document.getElementById('loading').classList.add('show');
            document.getElementById('results-section').classList.remove('show');

            // Ê®°ÊãüÂä†ËΩΩÂª∂Ëøü
            setTimeout(() => {
                const names = selectNames(gender, meanings);
                displayResults(surname, names);

                document.getElementById('loading').classList.remove('show');
                document.getElementById('results-section').classList.add('show');

                // ÊªöÂä®Âà∞ÁªìÊûú
                document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
            }, 1500);
        }

        // ÈáçÊñ∞ÁîüÊàê
        function regenerateNames() {
            if (currentFormData) {
                generateNames();
            }
        }

        // ÈÄâÊã©ÂêçÂ≠ó
        function selectNames(gender, meanings) {
            const db = nameDatabase[gender];
            let allNames = [];

            // ÂçïÂ≠óÂêç
            db.single.forEach(item => {
                const score = calculateScore(item, meanings);
                allNames.push({
                    name: item.char,
                    pinyin: item.pinyin,
                    meaning: item.meaning,
                    element: item.element,
                    score: score,
                    type: 'single'
                });
            });

            // ÂèåÂ≠óÂêç
            db.double.forEach(item => {
                const score = calculateScore(item, meanings);
                allNames.push({
                    name: item.chars,
                    pinyin: item.pinyin,
                    meaning: item.meaning,
                    element: item.element,
                    score: score,
                    type: 'double'
                });
            });

            // ÊåâÂàÜÊï∞ÊéíÂ∫è
            allNames.sort((a, b) => b.score - a.score);

            // ËøîÂõûÂâç6‰∏™
            return allNames.slice(0, 6);
        }

        // ËÆ°ÁÆóÂàÜÊï∞
        function calculateScore(nameItem, selectedMeanings) {
            let score = 85 + Math.floor(Math.random() * 10); // Âü∫Á°ÄÂàÜ 85-95

            // Â¶ÇÊûúÈÄâÊã©‰∫ÜÂØìÊÑè‰∏îÂåπÈÖçÔºåÂä†ÂàÜ
            if (selectedMeanings.length > 0) {
                const matchCount = nameItem.tags.filter(tag =>
                    selectedMeanings.includes(tag)
                ).length;
                score += matchCount * 2;
            }

            return Math.min(score, 99);
        }

        // ÊòæÁ§∫ÁªìÊûú
        function displayResults(surname, names) {
            const container = document.getElementById('results-container');
            container.innerHTML = '';

            names.forEach((nameData, index) => {
                const fullName = surname + nameData.name;
                const isFavorited = favorites.some(f => f.fullName === fullName);

                const card = document.createElement('div');
                card.className = 'name-card';
                card.innerHTML = `
                    <div class="name-title">
                        <div class="name-text">${fullName}</div>
                        <div class="score">${nameData.score}ÂàÜ</div>
                    </div>
                    <div class="name-info">
                        <div class="info-row">
                            <span class="info-label">ÊãºÈü≥Ôºö</span>
                            <span class="info-value">${nameData.pinyin}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">ÂØìÊÑèÔºö</span>
                            <span class="info-value">${nameData.meaning}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">‰∫îË°åÔºö</span>
                            <span class="info-value">${nameData.element}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Èü≥ÂæãÔºö</span>
                            <span class="info-value">Âπ≥‰ªÑÂçèË∞ÉÔºåÊúóÊúó‰∏äÂè£</span>
                        </div>
                    </div>
                    <div class="actions">
                        <button class="action-btn ${isFavorited ? 'favorited' : ''}" onclick="toggleFavorite('${fullName}', ${index})">
                            ${isFavorited ? '‚ù§Ô∏è Â∑≤Êî∂Ëóè' : 'ü§ç Êî∂Ëóè'}
                        </button>
                        <button class="action-btn" onclick="shareName('${fullName}', '${nameData.meaning}', ${nameData.score})">
                            üì§ ÂàÜ‰∫´
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Êî∂Ëóè/ÂèñÊ∂àÊî∂Ëóè
        function toggleFavorite(fullName, index) {
            const existingIndex = favorites.findIndex(f => f.fullName === fullName);

            if (existingIndex > -1) {
                favorites.splice(existingIndex, 1);
            } else {
                const cards = document.querySelectorAll('.name-card');
                const card = cards[index];
                const pinyin = card.querySelector('.info-value').textContent;
                const meaning = card.querySelectorAll('.info-value')[1].textContent;
                const element = card.querySelectorAll('.info-value')[2].textContent;
                const score = card.querySelector('.score').textContent;

                favorites.push({
                    fullName,
                    pinyin,
                    meaning,
                    element,
                    score,
                    timestamp: Date.now()
                });
            }

            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateFavoritesCount();

            // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
            const btn = event.target;
            if (existingIndex > -1) {
                btn.classList.remove('favorited');
                btn.innerHTML = 'ü§ç Êî∂Ëóè';
            } else {
                btn.classList.add('favorited');
                btn.innerHTML = '‚ù§Ô∏è Â∑≤Êî∂Ëóè';
            }
        }

        // ÊòæÁ§∫Êî∂Ëóè
        function displayFavorites() {
            const container = document.getElementById('favorites-container');

            if (favorites.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                        <p>ËøòÊ≤°ÊúâÊî∂ËóèÁöÑÂêçÂ≠ó</p>
                        <p style="font-size: 14px; margin-top: 10px;">Âø´ÂéªÊô∫ËÉΩÂèñÂêçÈ°µÈù¢ÊåëÈÄâÂñúÊ¨¢ÁöÑÂêçÂ≠óÂêß</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = '';
            favorites.reverse().forEach((fav, index) => {
                const card = document.createElement('div');
                card.className = 'name-card';
                card.innerHTML = `
                    <div class="name-title">
                        <div class="name-text">${fav.fullName}</div>
                        <div class="score">${fav.score}</div>
                    </div>
                    <div class="name-info">
                        <div class="info-row">
                            <span class="info-label">ÊãºÈü≥Ôºö</span>
                            <span class="info-value">${fav.pinyin}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">ÂØìÊÑèÔºö</span>
                            <span class="info-value">${fav.meaning}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">‰∫îË°åÔºö</span>
                            <span class="info-value">${fav.element}</span>
                        </div>
                    </div>
                    <div class="actions">
                        <button class="action-btn" onclick="removeFavorite(${favorites.length - 1 - index})">
                            üóëÔ∏è Âà†Èô§
                        </button>
                        <button class="action-btn" onclick="shareName('${fav.fullName}', '${fav.meaning}', '${fav.score}')">
                            üì§ ÂàÜ‰∫´
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
            favorites.reverse();
        }

        // Âà†Èô§Êî∂Ëóè
        function removeFavorite(index) {
            favorites.splice(index, 1);
            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateFavoritesCount();
            displayFavorites();
        }

        // ÂàÜ‰∫´ÂêçÂ≠ó
        function shareName(fullName, meaning, score) {
            const text = `„Äê‰∏≠ÊñáÂèñÂêçÁ•ûÂô®Êé®Ëçê„Äë\n\nÂßìÂêçÔºö${fullName}\nÂØìÊÑèÔºö${meaning}\nËØÑÂàÜÔºö${score}\n\nËøôÊòØ‰∏Ä‰∏™Á≤æÂøÉÊåëÈÄâÁöÑÂ•ΩÂêçÂ≠óÔºÅ`;

            if (navigator.share) {
                navigator.share({
                    title: '‰∏≠ÊñáÂèñÂêçÁ•ûÂô®',
                    text: text
                }).catch(() => {});
            } else {
                // Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('ÂêçÂ≠ó‰ø°ÊÅØÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ');
            }
        }

        // ÂàùÂßãÂåñ
        updateFavoritesCount();
    </script>
</body>
</html>