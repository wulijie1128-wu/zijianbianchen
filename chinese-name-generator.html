<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­æ–‡å–åç¥å™¨ - ä¸“ä¸šå®å®èµ·åå·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", "PingFang SC", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 16px;
            opacity: 0.95;
        }

        .form-section {
            padding: 40px 30px;
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-group label {
            display: block;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
        }

        .form-group label .required {
            color: #f5576c;
        }

        .form-group input[type="text"],
        .form-group input[type="date"] {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
        }

        .gender-options,
        .meaning-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .radio-card {
            position: relative;
        }

        .radio-card input[type="radio"],
        .radio-card input[type="checkbox"] {
            position: absolute;
            opacity: 0;
        }

        .radio-card label {
            display: block;
            padding: 14px 28px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #666;
        }

        .radio-card input:checked + label {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102,126,234,0.3);
        }

        .radio-card label:hover {
            border-color: #667eea;
        }

        .generate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(102,126,234,0.4);
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102,126,234,0.5);
        }

        .generate-btn:active {
            transform: translateY(0);
        }

        .results-section {
            padding: 40px 30px;
            background: #f8f9fa;
            display: none;
        }

        .results-section.show {
            display: block;
        }

        .results-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .results-header h2 {
            font-size: 26px;
            color: #333;
            margin-bottom: 8px;
        }

        .results-header p {
            color: #666;
            font-size: 14px;
        }

        .name-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border-left: 4px solid #667eea;
        }

        .name-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .name-card .name-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .name-card .name-text {
            font-size: 28px;
            font-weight: 700;
            color: #333;
        }

        .name-card .score {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 600;
        }

        .name-card .name-info {
            margin-bottom: 12px;
        }

        .name-card .info-row {
            display: flex;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .name-card .info-label {
            color: #888;
            min-width: 70px;
        }

        .name-card .info-value {
            color: #333;
            flex: 1;
        }

        .name-card .actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .action-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .action-btn:hover {
            background: #667eea;
            color: white;
        }

        .action-btn.favorited {
            background: #667eea;
            color: white;
        }

        .regenerate-btn {
            display: block;
            width: 100%;
            padding: 14px;
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .regenerate-btn:hover {
            background: #667eea;
            color: white;
        }

        .favorites-section {
            padding: 40px 30px;
            display: none;
        }

        .favorites-section.show {
            display: block;
        }

        .tab-buttons {
            display: flex;
            gap: 10px;
            padding: 20px 30px 0;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab-btn {
            padding: 12px 24px;
            background: transparent;
            border: none;
            color: #666;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: #667eea;
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #667eea;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        @media (max-width: 600px) {
            .header h1 {
                font-size: 24px;
            }

            .form-section,
            .results-section,
            .favorites-section {
                padding: 30px 20px;
            }

            .gender-options,
            .meaning-options {
                flex-direction: column;
            }

            .radio-card label {
                text-align: center;
            }

            .name-card .name-text {
                font-size: 24px;
            }
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‹ ä¸­æ–‡å–åç¥å™¨</h1>
            <p>ä¸“ä¸šå®å®èµ·åå·¥å…· Â· åŸºäºéŸ³å¾‹ã€äº”è¡Œã€å¯“æ„æ™ºèƒ½æ¨è</p>
        </div>

        <div class="tab-buttons">
            <button class="tab-btn active" onclick="switchTab('generate')">æ™ºèƒ½å–å</button>
            <button class="tab-btn" onclick="switchTab('favorites')">æ”¶è—å¤¹ (<span id="favorites-count">0</span>)</button>
        </div>

        <div class="form-section" id="generate-tab">
            <form id="name-form">
                <div class="form-group">
                    <label><span class="required">*</span> å§“æ°</label>
                    <input type="text" id="surname" placeholder="è¯·è¾“å…¥å§“æ°ï¼Œå¦‚ï¼šå¼ ã€æã€ç‹" required maxlength="2">
                </div>

                <div class="form-group">
                    <label><span class="required">*</span> æ€§åˆ«</label>
                    <div class="gender-options">
                        <div class="radio-card">
                            <input type="radio" id="male" name="gender" value="male" required>
                            <label for="male">ğŸ‘¦ ç”·å­©</label>
                        </div>
                        <div class="radio-card">
                            <input type="radio" id="female" name="gender" value="female">
                            <label for="female">ğŸ‘§ å¥³å­©</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>å‡ºç”Ÿæ—¥æœŸï¼ˆå¯é€‰ï¼Œç”¨äºäº”è¡Œåˆ†æï¼‰</label>
                    <input type="date" id="birthdate">
                </div>

                <div class="form-group">
                    <label>æœŸæœ›å¯“æ„ï¼ˆå¯å¤šé€‰ï¼‰</label>
                    <div class="meaning-options">
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-wisdom" value="æ™ºæ…§">
                            <label for="meaning-wisdom">ğŸ’¡ æ™ºæ…§èªé¢–</label>
                        </div>
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-virtue" value="å“å¾·">
                            <label for="meaning-virtue">ğŸŒŸ å“å¾·é«˜å°š</label>
                        </div>
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-health" value="å¥åº·">
                            <label for="meaning-health">ğŸ’ª å¥åº·å¹³å®‰</label>
                        </div>
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-success" value="æˆåŠŸ">
                            <label for="meaning-success">ğŸ† äº‹ä¸šæœ‰æˆ</label>
                        </div>
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-beauty" value="ç¾ä¸½">
                            <label for="meaning-beauty">ğŸŒ¸ ç¾ä¸½ä¼˜é›…</label>
                        </div>
                        <div class="radio-card">
                            <input type="checkbox" id="meaning-courage" value="å‹‡æ•¢">
                            <label for="meaning-courage">âš”ï¸ å‹‡æ•¢åšå¼º</label>
                        </div>
                    </div>
                </div>

                <button type="submit" class="generate-btn">âœ¨ å¼€å§‹æ™ºèƒ½å–å</button>
            </form>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>æ­£åœ¨ä¸ºæ‚¨ç²¾å¿ƒæŒ‘é€‰å¥½åå­—...</p>
        </div>

        <div class="results-section" id="results-section">
            <div class="results-header">
                <h2>ä¸ºæ‚¨æ¨èä»¥ä¸‹å¥½åå­—</h2>
                <p>å·²æ ¹æ®éŸ³å¾‹ã€äº”è¡Œã€å¯“æ„ç»¼åˆåˆ†æ</p>
            </div>
            <div id="results-container"></div>
            <button class="regenerate-btn" onclick="regenerateNames()">ğŸ”„ æ¢ä¸€æ‰¹</button>
        </div>

        <div class="favorites-section" id="favorites-tab">
            <div class="results-header">
                <h2>æˆ‘çš„æ”¶è—</h2>
                <p>æ‚¨æ”¶è—çš„åå­—å°†ä¿å­˜åœ¨æœ¬åœ°</p>
            </div>
            <div id="favorites-container"></div>
        </div>
    </div>

    <script>
        // åå­—åº“
        const nameDatabase = {
            male: {
                single: [
                    { char: 'è½©', pinyin: 'xuÄn', meaning: 'æ°”å®‡è½©æ˜‚', element: 'åœŸ', tags: ['æ™ºæ…§', 'å“å¾·'] },
                    { char: 'å®‡', pinyin: 'yÇ”', meaning: 'èƒ¸æ€€å®½å¹¿', element: 'åœŸ', tags: ['æ™ºæ…§', 'æˆåŠŸ'] },
                    { char: 'æµ©', pinyin: 'hÃ o', meaning: 'æµ©ç„¶æ­£æ°”', element: 'æ°´', tags: ['å‹‡æ•¢', 'å“å¾·'] },
                    { char: 'ç¿', pinyin: 'ruÃ¬', meaning: 'èªæ˜ç¿æ™º', element: 'é‡‘', tags: ['æ™ºæ…§'] },
                    { char: 'åš', pinyin: 'bÃ³', meaning: 'åšå­¦å¤šæ‰', element: 'æ°´', tags: ['æ™ºæ…§', 'æˆåŠŸ'] },
                    { char: 'ç¿°', pinyin: 'hÃ n', meaning: 'æ–‡é‡‡é£æ‰¬', element: 'æ°´', tags: ['æ™ºæ…§', 'æˆåŠŸ'] },
                    { char: 'æ³½', pinyin: 'zÃ©', meaning: 'æ©æ³½ä¸‡ç‰©', element: 'æ°´', tags: ['å“å¾·', 'æˆåŠŸ'] },
                    { char: 'æ™¨', pinyin: 'chÃ©n', meaning: 'æœæ°”è“¬å‹ƒ', element: 'ç«', tags: ['å¥åº·', 'æˆåŠŸ'] },
                    { char: 'æ¯…', pinyin: 'yÃ¬', meaning: 'åšæ¯…æœæ•¢', element: 'æœ¨', tags: ['å‹‡æ•¢', 'æˆåŠŸ'] },
                    { char: 'æ°', pinyin: 'jiÃ©', meaning: 'è‹±é›„è±ªæ°', element: 'æœ¨', tags: ['å‹‡æ•¢', 'æˆåŠŸ'] },
                    { char: 'ç‘', pinyin: 'ruÃ¬', meaning: 'ç¥¥ç‘å‰ç¥¥', element: 'é‡‘', tags: ['å¥åº·', 'å“å¾·'] },
                    { char: 'ç…œ', pinyin: 'yÃ¹', meaning: 'å…‰æ˜ç…§è€€', element: 'ç«', tags: ['æˆåŠŸ', 'æ™ºæ…§'] },
                ],
                double: [
                    { chars: 'å®‡èˆª', pinyin: 'yÇ”hÃ¡ng', meaning: 'å¿—å‘é«˜è¿œ', element: 'åœŸæ°´', tags: ['æ™ºæ…§', 'æˆåŠŸ'] },
                    { chars: 'æµ©ç„¶', pinyin: 'hÃ orÃ¡n', meaning: 'æµ©ç„¶æ­£æ°”', element: 'æ°´é‡‘', tags: ['å“å¾·', 'å‹‡æ•¢'] },
                    { chars: 'æ™¨æ›¦', pinyin: 'chÃ©nxÄ«', meaning: 'æœé˜³åˆå‡', element: 'ç«ç«', tags: ['å¥åº·', 'æˆåŠŸ'] },
                    { chars: 'ç¿æ³½', pinyin: 'ruÃ¬zÃ©', meaning: 'æ™ºæ…§æ©æ³½', element: 'é‡‘æ°´', tags: ['æ™ºæ…§', 'å“å¾·'] },
                    { chars: 'åšæ–‡', pinyin: 'bÃ³wÃ©n', meaning: 'åšå­¦å¤šè¯†', element: 'æ°´æ°´', tags: ['æ™ºæ…§', 'æˆåŠŸ'] },
                    { chars: 'å­è½©', pinyin: 'zÇxuÄn', meaning: 'ç¿©ç¿©å›å­', element: 'æ°´åœŸ', tags: ['å“å¾·', 'æ™ºæ…§'] },
                    { chars: 'ç…œç¥º', pinyin: 'yÃ¹qÃ­', meaning: 'å…‰æ˜å‰ç¥¥', element: 'ç«æœ¨', tags: ['æˆåŠŸ', 'å¥åº·'] },
                    { chars: 'ä¿Šæ°', pinyin: 'jÃ¹njiÃ©', meaning: 'è‹±ä¿Šè±ªæ°', element: 'ç«æœ¨', tags: ['å‹‡æ•¢', 'æˆåŠŸ'] },
                ]
            },
            female: {
                single: [
                    { char: 'è±', pinyin: 'xuÄn', meaning: 'ç¾ä¸½å¿«ä¹', element: 'æœ¨', tags: ['ç¾ä¸½', 'å¥åº·'] },
                    { char: 'ç‘¶', pinyin: 'yÃ¡o', meaning: 'ç¾ç‰æ— ç‘•', element: 'ç«', tags: ['ç¾ä¸½', 'å“å¾·'] },
                    { char: 'å©·', pinyin: 'tÃ­ng', meaning: 'å©€å¨œå¤šå§¿', element: 'ç«', tags: ['ç¾ä¸½'] },
                    { char: 'é›…', pinyin: 'yÇ', meaning: 'æ¸©æ–‡å°”é›…', element: 'æœ¨', tags: ['å“å¾·', 'ç¾ä¸½'] },
                    { char: 'æ…§', pinyin: 'huÃ¬', meaning: 'èªæ…§ä¼¶ä¿', element: 'æ°´', tags: ['æ™ºæ…§'] },
                    { char: 'ç³', pinyin: 'lÃ­n', meaning: 'ç¾ç‰å…‰å½©', element: 'æœ¨', tags: ['ç¾ä¸½'] },
                    { char: 'æ¶µ', pinyin: 'hÃ¡n', meaning: 'æ¶µå…»ä¿®å…»', element: 'æ°´', tags: ['å“å¾·', 'æ™ºæ…§'] },
                    { char: 'æ¬£', pinyin: 'xÄ«n', meaning: 'æ¬£æ¬£å‘è£', element: 'æœ¨', tags: ['å¥åº·', 'ç¾ä¸½'] },
                    { char: 'æ‚¦', pinyin: 'yuÃ¨', meaning: 'å–œæ‚¦å¿«ä¹', element: 'é‡‘', tags: ['å¥åº·', 'ç¾ä¸½'] },
                    { char: 'èŠ¸', pinyin: 'yÃºn', meaning: 'å‹¤å¥‹ä¸Šè¿›', element: 'æœ¨', tags: ['æ™ºæ…§', 'æˆåŠŸ'] },
                    { char: 'é¢–', pinyin: 'yÇng', meaning: 'èªé¢–å‡ºä¼—', element: 'æœ¨', tags: ['æ™ºæ…§', 'æˆåŠŸ'] },
                    { char: 'å©‰', pinyin: 'wÇn', meaning: 'æ¸©å©‰è´¤æ·‘', element: 'åœŸ', tags: ['ç¾ä¸½', 'å“å¾·'] },
                ],
                double: [
                    { chars: 'é›…æ¶µ', pinyin: 'yÇhÃ¡n', meaning: 'ä¼˜é›…å«è“„', element: 'æœ¨æ°´', tags: ['å“å¾·', 'ç¾ä¸½'] },
                    { chars: 'è¯—æ¶µ', pinyin: 'shÄ«hÃ¡n', meaning: 'è¯—æƒ…ç”»æ„', element: 'é‡‘æ°´', tags: ['æ™ºæ…§', 'ç¾ä¸½'] },
                    { chars: 'æ¢¦çª', pinyin: 'mÃ¨ngqÃ­', meaning: 'ç¾æ¢¦æˆçœŸ', element: 'æœ¨æœ¨', tags: ['ç¾ä¸½', 'æˆåŠŸ'] },
                    { chars: 'æ¬£æ€¡', pinyin: 'xÄ«nyÃ­', meaning: 'æ¬£å–œæ„‰æ‚¦', element: 'æœ¨åœŸ', tags: ['å¥åº·', 'ç¾ä¸½'] },
                    { chars: 'è¯­å«£', pinyin: 'yÇ”yÄn', meaning: 'å·§ç¬‘å«£ç„¶', element: 'æœ¨åœŸ', tags: ['ç¾ä¸½', 'å“å¾·'] },
                    { chars: 'å©‰å©·', pinyin: 'wÇntÃ­ng', meaning: 'å©‰çº¦å©·å©·', element: 'åœŸç«', tags: ['ç¾ä¸½', 'å“å¾·'] },
                    { chars: 'æ€æ…§', pinyin: 'sÄ«huÃ¬', meaning: 'æ€ç»´æ•æ…§', element: 'é‡‘æ°´', tags: ['æ™ºæ…§'] },
                    { chars: 'æ‚¦å½¤', pinyin: 'yuÃ¨tÃ³ng', meaning: 'å–œæ‚¦å¦‚é˜³', element: 'é‡‘ç«', tags: ['å¥åº·', 'ç¾ä¸½'] },
                ]
            }
        };

        let currentFormData = null;
        let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');

        // æ›´æ–°æ”¶è—è®¡æ•°
        function updateFavoritesCount() {
            document.getElementById('favorites-count').textContent = favorites.length;
        }

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tab) {
            const tabs = document.querySelectorAll('.tab-btn');
            tabs.forEach(t => t.classList.remove('active'));

            if (tab === 'generate') {
                document.querySelector('.tab-btn:first-child').classList.add('active');
                document.getElementById('generate-tab').style.display = 'block';
                document.getElementById('favorites-tab').classList.remove('show');
                document.getElementById('results-section').style.display = 'none';
            } else {
                document.querySelector('.tab-btn:last-child').classList.add('active');
                document.getElementById('generate-tab').style.display = 'none';
                document.getElementById('results-section').style.display = 'none';
                document.getElementById('favorites-tab').classList.add('show');
                displayFavorites();
            }
        }

        // è¡¨å•æäº¤
        document.getElementById('name-form').addEventListener('submit', function(e) {
            e.preventDefault();
            generateNames();
        });

        // ç”Ÿæˆåå­—
        function generateNames() {
            const surname = document.getElementById('surname').value.trim();
            const gender = document.querySelector('input[name="gender"]:checked').value;
            const birthdate = document.getElementById('birthdate').value;
            const meanings = Array.from(document.querySelectorAll('input[type="checkbox"]:checked'))
                .map(cb => cb.value);

            currentFormData = { surname, gender, birthdate, meanings };

            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            document.getElementById('loading').classList.add('show');
            document.getElementById('results-section').classList.remove('show');

            // æ¨¡æ‹ŸåŠ è½½å»¶è¿Ÿ
            setTimeout(() => {
                const names = selectNames(gender, meanings);
                displayResults(surname, names);

                document.getElementById('loading').classList.remove('show');
                document.getElementById('results-section').classList.add('show');

                // æ»šåŠ¨åˆ°ç»“æœ
                document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
            }, 1500);
        }

        // é‡æ–°ç”Ÿæˆ
        function regenerateNames() {
            if (currentFormData) {
                generateNames();
            }
        }

        // é€‰æ‹©åå­—
        function selectNames(gender, meanings) {
            const db = nameDatabase[gender];
            let allNames = [];

            // å•å­—å
            db.single.forEach(item => {
                const score = calculateScore(item, meanings);
                allNames.push({
                    name: item.char,
                    pinyin: item.pinyin,
                    meaning: item.meaning,
                    element: item.element,
                    score: score,
                    type: 'single'
                });
            });

            // åŒå­—å
            db.double.forEach(item => {
                const score = calculateScore(item, meanings);
                allNames.push({
                    name: item.chars,
                    pinyin: item.pinyin,
                    meaning: item.meaning,
                    element: item.element,
                    score: score,
                    type: 'double'
                });
            });

            // æŒ‰åˆ†æ•°æ’åº
            allNames.sort((a, b) => b.score - a.score);

            // è¿”å›å‰6ä¸ª
            return allNames.slice(0, 6);
        }

        // è®¡ç®—åˆ†æ•°
        function calculateScore(nameItem, selectedMeanings) {
            let score = 85 + Math.floor(Math.random() * 10); // åŸºç¡€åˆ† 85-95

            // å¦‚æœé€‰æ‹©äº†å¯“æ„ä¸”åŒ¹é…ï¼ŒåŠ åˆ†
            if (selectedMeanings.length > 0) {
                const matchCount = nameItem.tags.filter(tag =>
                    selectedMeanings.includes(tag)
                ).length;
                score += matchCount * 2;
            }

            return Math.min(score, 99);
        }

        // æ˜¾ç¤ºç»“æœ
        function displayResults(surname, names) {
            const container = document.getElementById('results-container');
            container.innerHTML = '';

            names.forEach((nameData, index) => {
                const fullName = surname + nameData.name;
                const isFavorited = favorites.some(f => f.fullName === fullName);

                const card = document.createElement('div');
                card.className = 'name-card';
                card.innerHTML = `
                    <div class="name-title">
                        <div class="name-text">${fullName}</div>
                        <div class="score">${nameData.score}åˆ†</div>
                    </div>
                    <div class="name-info">
                        <div class="info-row">
                            <span class="info-label">æ‹¼éŸ³ï¼š</span>
                            <span class="info-value">${nameData.pinyin}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">å¯“æ„ï¼š</span>
                            <span class="info-value">${nameData.meaning}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">äº”è¡Œï¼š</span>
                            <span class="info-value">${nameData.element}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">éŸ³å¾‹ï¼š</span>
                            <span class="info-value">å¹³ä»„åè°ƒï¼Œæœ—æœ—ä¸Šå£</span>
                        </div>
                    </div>
                    <div class="actions">
                        <button class="action-btn ${isFavorited ? 'favorited' : ''}" onclick="toggleFavorite('${fullName}', ${index})">
                            ${isFavorited ? 'â¤ï¸ å·²æ”¶è—' : 'ğŸ¤ æ”¶è—'}
                        </button>
                        <button class="action-btn" onclick="shareName('${fullName}', '${nameData.meaning}', ${nameData.score})">
                            ğŸ“¤ åˆ†äº«
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // æ”¶è—/å–æ¶ˆæ”¶è—
        function toggleFavorite(fullName, index) {
            const existingIndex = favorites.findIndex(f => f.fullName === fullName);

            if (existingIndex > -1) {
                favorites.splice(existingIndex, 1);
            } else {
                const cards = document.querySelectorAll('.name-card');
                const card = cards[index];
                const pinyin = card.querySelector('.info-value').textContent;
                const meaning = card.querySelectorAll('.info-value')[1].textContent;
                const element = card.querySelectorAll('.info-value')[2].textContent;
                const score = card.querySelector('.score').textContent;

                favorites.push({
                    fullName,
                    pinyin,
                    meaning,
                    element,
                    score,
                    timestamp: Date.now()
                });
            }

            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateFavoritesCount();

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            const btn = event.target;
            if (existingIndex > -1) {
                btn.classList.remove('favorited');
                btn.innerHTML = 'ğŸ¤ æ”¶è—';
            } else {
                btn.classList.add('favorited');
                btn.innerHTML = 'â¤ï¸ å·²æ”¶è—';
            }
        }

        // æ˜¾ç¤ºæ”¶è—
        function displayFavorites() {
            const container = document.getElementById('favorites-container');

            if (favorites.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                        <p>è¿˜æ²¡æœ‰æ”¶è—çš„åå­—</p>
                        <p style="font-size: 14px; margin-top: 10px;">å¿«å»æ™ºèƒ½å–åé¡µé¢æŒ‘é€‰å–œæ¬¢çš„åå­—å§</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = '';
            favorites.reverse().forEach((fav, index) => {
                const card = document.createElement('div');
                card.className = 'name-card';
                card.innerHTML = `
                    <div class="name-title">
                        <div class="name-text">${fav.fullName}</div>
                        <div class="score">${fav.score}</div>
                    </div>
                    <div class="name-info">
                        <div class="info-row">
                            <span class="info-label">æ‹¼éŸ³ï¼š</span>
                            <span class="info-value">${fav.pinyin}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">å¯“æ„ï¼š</span>
                            <span class="info-value">${fav.meaning}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">äº”è¡Œï¼š</span>
                            <span class="info-value">${fav.element}</span>
                        </div>
                    </div>
                    <div class="actions">
                        <button class="action-btn" onclick="removeFavorite(${favorites.length - 1 - index})">
                            ğŸ—‘ï¸ åˆ é™¤
                        </button>
                        <button class="action-btn" onclick="shareName('${fav.fullName}', '${fav.meaning}', '${fav.score}')">
                            ğŸ“¤ åˆ†äº«
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
            favorites.reverse();
        }

        // åˆ é™¤æ”¶è—
        function removeFavorite(index) {
            favorites.splice(index, 1);
            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateFavoritesCount();
            displayFavorites();
        }

        // åˆ†äº«åå­—
        function shareName(fullName, meaning, score) {
            const text = `ã€ä¸­æ–‡å–åç¥å™¨æ¨èã€‘\n\nå§“åï¼š${fullName}\nå¯“æ„ï¼š${meaning}\nè¯„åˆ†ï¼š${score}\n\nè¿™æ˜¯ä¸€ä¸ªç²¾å¿ƒæŒ‘é€‰çš„å¥½åå­—ï¼`;

            if (navigator.share) {
                navigator.share({
                    title: 'ä¸­æ–‡å–åç¥å™¨',
                    text: text
                }).catch(() => {});
            } else {
                // å¤åˆ¶åˆ°å‰ªè´´æ¿
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('åå­—ä¿¡æ¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }
        }

        // åˆå§‹åŒ–
        updateFavoritesCount();
    </script>
</body>
</html>